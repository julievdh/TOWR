heatmap.2(H.mat, density.info = "none", trace = "none", col = my_palette, symkey = FALSE)
## matrix containing data for all depths/tows/speeds
H.mat2 <- matrix(NA, nrow=length(files), ncol=9)
# loop through files
for(i in 1:length(files)){
# load data
dat <- read.csv(files[i],header=FALSE)
# sort by speed
# sortdat <- dat[order(dat$V2),]
H.mat2[i, 1:9] = t(dat$V3)
}
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE)
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE)
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none")
heatmap.2(H.mat2, density.info = "none", trace = "none", breaks = colors, col = my_palette, symkey = FALSE,symm = FALSE, scale = "none")
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none")
?cluster
??cluster
source('~/.active-rstudio-document', echo=TRUE)
my_palette <- colorRampPalette(c("yellow","red","white","blue"))(n = 299)
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none")
my_palette <- colorRampPalette(c("green","black","red","yellow","blue"))(n = 299)
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none")
my_palette <- colorRampPalette(c("green","black","blue","yellow","red"))(n = 299)
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none")
my_palette <- colorRampPalette(c("green","black","white","blue","yellow","red"))(n = 299)
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none")
my_palette <- colorRampPalette(c("green","black","blue","yellow","red"))(n = 1000)
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none")
my_palette <- colorRampPalette(c("green","black","blue","yellow"))(n = 1000)
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none")
,"red"
my_palette <- colorRampPalette(c("green","black","blue","yellow","red"))(n = 1000)
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none")
my_palette <- colorRampPalette(c("green","black","blue","yellow","black"))(n = 1000)
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none")
my_palette <- colorRampPalette(c("green","black","white","blue","black"))(n = 1000)
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none")
files
rownames(H.mat2) <- files
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none")
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none",margins = c(12,9))
heatmap.2(H.mat2, density.info = "none", trace = "none", col = my_palette, symkey = FALSE,symm = FALSE, scale = "none", margins = c(5,12))
H.df2<-melt(H.mat2)
library(reshape2)
H.df2<-melt(H.mat2)
View(H.df2)
View(H.df2)
View(dat)
heatmap.2(H.mat2, density.info = "none", trace = "none", col = redgreen(75), ColsideColors = col, symkey = FALSE,symm = FALSE, scale = "none", margins = c(5,12))
heatmap.2(H.mat2, density.info = "none", trace = "none", col = redgreen(75), ColSideColors = col, symkey = FALSE,symm = FALSE, scale = "none", margins = c(5,12))
heatmap.2(H.mat2, density.info = "none", trace = "none", col = redgreen(75), ColSideColors = col, symkey = FALSE,symm = FALSE, scale = "row", margins = c(5,12))
heatmap.2(H.mat2, density.info = "none", trace = "none", col = redgreen(75), scale = "row", ColSideColors = col, symkey = FALSE,symm = FALSE, margins = c(5,12))
ncol(H.mat2)
col
heatmap.2(H.mat2, density.info = "none", trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(H.mat2, density.info = "none", trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
distance = dis(H.mat2,method = "manhattan")
distance = dist(H.mat2,method = "manhattan")
cluster = hclust(distance,method="ward")
cluster = hclust(distance,method="ward.D")
cluster
plot(cluster)
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(cluster),
Colv = as.dendrogram(cluster)),
trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(cluster),
Colv = as.dendrogram(cluster)), trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(cluster), Colv = as.dendrogram(cluster)), trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(cluster), Colv = as.dendrogram(cluster)), trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(cluster), Colv = as.dendrogram(cluster), trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(cluster), trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
row_distance = dist(H.mat2, method = "manhattan")
row_cluster = hclust(row_distance, method = "ward")
col_distance = dist(t(H.mat2), method = "manhattan")
col_cluster = hclust(col_distance, method = "ward")
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
row_distance = dist(H.mat2, method = "minkowski")
row_cluster = hclust(row_distance, method = "ward")
col_distance = dist(t(H.mat2), method = "minkowski")
col_cluster = hclust(col_distance, method = "ward")
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
row_distance = dist(H.mat2, method = "canberra")
row_cluster = hclust(row_distance, method = "ward")
col_distance = dist(t(H.mat2), method = "canberra")
col_cluster = hclust(col_distance, method = "ward")
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
?hclust
row_distance = dist(H.mat2, method = "maximum")
row_cluster = hclust(row_distance, method = "ward")
col_distance = dist(t(H.mat2), method = "maximum")
col_cluster = hclust(col_distance, method = "ward")
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
row_distance = dist(H.mat2, method = "maximum")
row_cluster = hclust(row_distance, method = "ward")
col_distance = dist(t(H.mat2), method = "maximum")
col_cluster = hclust(col_distance, method = "ward")
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
row_distance = dist(H.mat2, method = "euclidean")
row_cluster = hclust(row_distance, method = "ward")
col_distance = dist(t(H.mat2), method = "euclidean")
col_cluster = hclust(col_distance, method = "ward")
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
row_distance = dist(H.mat2, method = "euclidean")
row_cluster = hclust(row_distance, method = "ward.D2")
col_distance = dist(t(H.mat2), method = "euclidean")
col_cluster = hclust(col_distance, method = "ward.D2")
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
row_distance = dist(H.mat2, method = "manhattan")
row_cluster = hclust(row_distance, method = "ward.D2")
col_distance = dist(t(H.mat2), method = "manhattan")
col_cluster = hclust(col_distance, method = "ward.D2")
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
row_distance = dist(H.mat2, method = "manhattan")
row_cluster = hclust(row_distance, method = "ward")
col_distance = dist(t(H.mat2), method = "manhattan")
col_cluster = hclust(col_distance, method = "ward")
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
Rowv
Rowv = rowMeans(H.mat2, na.rm = T)
dendrogram = reorder(dendrogram, Rowv)
Colv = colMeans(H.mat2,na.rm = T)
Colv
col_cluster = reorder(col_cluster,Colv)
col_cluster
Colv
reorder
col_cluster = reorder(col_cluster, Colv)
View(H.mat2)
H.mat2[:,1]
H.mat2[,1:9]
H.mat2[,1]
H.mat2[c(2,5),]
depth_ordered <- H.mat2[,c(1,4,7,2,5,8,3,6,9)]
depth_ordered <- H.mat2[,c(1,4,7,2,5,8,3,6,9)]
row_distance = dist(H.mat2, method = "manhattan")
row_cluster = hclust(row_distance, method = "ward")
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = "NA",trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
depth_ordered <- H.mat2[,c(1,4,7,2,5,8,3,6,9)]
row_distance = dist(depth_ordered, method = "manhattan")
row_cluster = hclust(row_distance, method = "ward")
heatmap.2(depth_ordered, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = "NA",trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = "NA",trace = "none", col = redgreen(75), scale = "row", symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   Rowv = as.dendrogram(row_cluster), breaks = breaks, Colv = "NA",trace = "none", col = redgreen(75), scale = "row", symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = "NA",trace = "none", col = redgreen(75), scale = "row", breaks = breaks, symkey = FALSE,symm = FALSE, margins = c(5,12))
? heatmap.2
heatmap.2(depth_ordered, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = "NA",trace = "none", col = redgreen(75), rowsep, scale = "row", symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = NA,trace = "none", col = redgreen(75), rowsep, scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   Rowv = as.dendrogram(row_cluster), trace = "none", col = redgreen(75), rowsep, scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   Rowv = as.dendrogram(row_cluster), trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = NA, trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = blueyellow(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = redblue(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = my_palette, scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
my_palette <- colorRampPalette(c("white","blue","black"))(n = 1000)
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = my_palette, scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = greenred(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(H.mat, density.info = "none", trace = "none", col = my_palette, symkey = FALSE)
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
row_distance = dist(H.mat2, method = "euclidean")
row_cluster = hclust(row_distance, method = "ward")
col_distance = dist(t(H.mat2), method = "euclidean")
col_cluster = hclust(col_distance, method = "ward")
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
rownames(H.mat2) <- files
row_distance = dist(H.mat2, method = "manhattan")
row_cluster = hclust(row_distance, method = "ward")
col_distance = dist(t(H.mat2), method = "manhattan")
col_cluster = hclust(col_distance, method = "ward")
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
# ORDER BY DEPTH
depth_ordered <- H.mat2[,c(1,4,7,2,5,8,3,6,9)]
row_distance = dist(depth_ordered, method = "manhattan")
row_cluster = hclust(row_distance, method = "ward")
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = greenre(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = redgreen(75), cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = colorRampPalette(brewer.pal(10, "RdBu"))(256), cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
library(RColorBrewer)
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = colorRampPalette(brewer.pal(10, "RdBu"))(256), cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
# create pdf
pdf("../AnalysisFigures/AllDendrogram_SpeedDepth",    # create PNG for the heat map
width = 5*300,        # 5 x 300 pixels
height = 8*300,
res = 300,            # 300 pixels per inch
pointsize = 8)        # smaller font size
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
rownames(H.mat2) <- files
row_distance = dist(H.mat2, method = "manhattan")
row_cluster = hclust(row_distance, method = "ward")
col_distance = dist(t(H.mat2), method = "manhattan")
col_cluster = hclust(col_distance, method = "ward")
# create pdf
pdf("../AnalysisFigures/AllDendrogram_SpeedDepth",    # create PNG for the heat map
width = 5*300,        # 5 x 300 pixels
height = 8*300,
res = 300,            # 300 pixels per inch
pointsize = 8)        # smaller font size
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
dev.off()
# create pdf
pdf("../AnalysisFigures/AllDendrogram_SpeedDepth",    # create PNG for the heat map
width = 5*300,        # 5 x 300 pixels
height = 8*300,
res = 300,            # 300 pixels per inch
pointsize = 8)        # smaller font size
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
dev.off()
?pdf
pdf("../AnalysisFigures/AllDendrogram_SpeedDepth",    # create PNG for the heat map
width = 5*300,        # 5 x 300 pixels
height = 8*300,
res = 300,            # 300 pixels per inch
pointsize = 8)        # smaller font size
pdf("../AnalysisFigures/AllDendrogram_SpeedDepth",    # create PNG for the heat map
width = 5*300,        # 5 x 300 pixels
height = 8*300,
pointsize = 8)        # smaller font size
pdf("../AnalysisFigures/AllDendrogram_SpeedDepth",    # create PNG for the heat map
width = 5*300,        # 5 x 300 pixels
height = 8*300,
pointsize = 8)        # smaller font size
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = colorRampPalette(brewer.pal(10, "RdBu"))(256), cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", scale = "row", col = colorRampPalette(brewer.pal(10, "RdBu"))(256), cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", scale = "row", col = -colorRampPalette(brewer.pal(10, "RdBu"))(256), cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
display.brewer.all(n=NULL, type="all", select=NULL, exact.n=TRUE)
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", scale = "row", col = colorRampPalette(brewer.pal(10, "PuRd"))(256), cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
display.brewer.all(n=NULL, type="all", select=NULL, exact.n=TRUE)
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", scale = "row", col = colorRampPalette(brewer.pal(10, "YlGnBu"))(256), cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", scale = "row", col = colorRampPalette(brewer.pal(9, "YlGnBu"))(256), cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = colorRampPalette(brewer.pal(9, "YlGnBu"))(256), cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
scale = "row",
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", scale = "row", col = colorRampPalette(brewer.pal(9, "YlGnBu"))(256), cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(H.mat2, density.info = "none",   Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),trace = "none", col = redgreen(75), scale = "row", cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
my_palette <- colorRampPalette(c("green","black","white","blue","black"))(n = 1000)
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = my_palette, cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,12))
heatmap.2(depth_ordered, density.info = "none",   dendrogram = "row", Rowv = as.dendrogram(row_cluster), Colv = "NA", trace = "none", col = my_palette, cexRow = 1, cexCol = 1, symkey = FALSE,symm = FALSE, margins = c(5,13))
heatmap.2(H.mat, density.info = "none", trace = "none", Colv = "NA",Rowv = "FALSE",col = my_palette)
palette <- colorRampPalette(c("blue","red"))(n = 24*3)
heatmap.2(H.mat, density.info = "none", trace = "none", Colv = "NA",Rowv = "FALSE",col = my_palette)
#######
heatmap.2(H.mat, density.info = "none", trace = "none", Colv = "NA",Rowv = "FALSE",col = my_palette)
source('~/Documents/R/DepthEffect_Plot.R', echo=TRUE)
heatmap.2(H.mat, density.info = "none", trace = "none", Colv = "NA",Rowv = "FALSE",col = my_palette, sort = "rows")
heatmap.2(H.mat, density.info = "none", trace = "none", Colv = "NA",Rowv = "FALSE",col = my_palette, scale = "rows")
heatmap.2(H.mat, density.info = "none", trace = "none", Colv = "NA",Rowv = "FALSE",col = my_palette, scale = "rows")
heatmap.2(H.mat, density.info = "none", trace = "none", Colv = "NA",Rowv = "FALSE",col = my_palette, scale = "row")
version
install.packages("maps")
install.packages("maps")
install.packages("maps")
setwd("~/Documents/R/TOWR/TOW_data")
## load libraries
library(AICcmodavg)
library(R.matlab)
## load gear data saved from MATLAB
data <- readMat('GearData.mat')
## set directory
setwd("~/Documents/R/TOWR")
## find all filenames
files <- list.files(path = "./TOW_data", pattern = ".csv")
## the matrix containing data for Files affected by depth
H.mat <- matrix(NA, nrow=length(files)*3, ncol=3)
# loop through files
for(i in 1:length(files)){
# load data
setwd("~/Documents/R/TOWR/TOW_data")
dat <- read.csv(files[i],header=FALSE)
H.mat[i*3-2, 1:3] = t(dat$V3[1:3])
H.mat[i*3-1, 1:3] = t(dat$V3[4:6])
H.mat[i*3, 1:3] = t(dat$V3[7:9])
}
View(H.mat)
View(H.mat)
H.mat2 <- matrix(NA, nrow=length(files), ncol=9)
# loop through files
for(i in 1:length(files)){
# load data
dat <- read.csv(files[i],header=FALSE)
# sort by speed
# sortdat <- dat[order(dat$V2),]
H.mat2[i, 1:9] = t(dat$V3)
}
View(H.mat2)
source('~/Documents/R/TOWR/DragCluster_Heatmap.R', echo=TRUE)
## load libraries
library(gplots)
library(RColorBrewer)
library(R.matlab)
## set directory
setwd("~/Documents/MATLAB/TOW/")
## load data
df <- readMat('CdRe_data.mat')
## set directory back
setwd("~/Documents/R/TOWR")
library(R.matlab)
## load libraries
library(gplots)
library(RColorBrewer)
library(R.matlab)
## set directory
setwd("~/Documents/MATLAB/TOW/")
## load data
df <- readMat('CdRe_data.mat')
## set directory back
setwd("~/Documents/R/TOWR")
View(df$Aw)
View(df$Cd)
YlOrBr <- c("#FFF7FB","#FFF7FB","#FFF7FB","#FFF7FB","#FFF7FB","#FFF7FB",
"#FFFFD9","#41B6C3", "#1D91C0", "#225ea8", "#253494", "#081D58","#000000")
my_palette <- colorRampPalette(YlOrBr, space = "Lab")(n = 1000)
rownames(df$Cd) <- sub(".*?20120912_(.*?).c.*", "\\1", name)
rownames(df$Cd) <- sub(".*?20120912_(.*?).c.*", "\\1", df$name)
row_distance = dist(df$Cd, method = "manhattan")
row_cluster = hclust(row_distance, method = "ward.D")
col_distance = dist(t(df$Cd), method = "manhattan")
col_cluster = hclust(col_distance, method = "ward.D")
heatmap.2(df$Cd, density.info = "none",
Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),
trace = "none", col = redgreen(75),
scale = "row", cexRow = 1, cexCol = 1,
symkey = FALSE,symm = FALSE,
srtCol = 0, # rotate column labels
margins = c(5,13))
# ORDER BY DEPTH
depth_ordered <- df$Cd[,c(1,4,7,2,5,8,3,6,9)]
row_distance = dist(depth_ordered, method = "manhattan")
row_cluster = hclust(row_distance, method = "ward.D")
setwd("~/Documents/R/TOWR/AnalysisFigures") # set directory to figures
# matrix for positions in heat map
# (1 = heatmap, 2 = row dendrogram, 3 = column dendrogram, 4 = key)
lmat = rbind(c(3,4),c(2,1))
par(mar=c(0,0,0,9))
par(oma=c(0,0,0,9))
pdf("Cd_Heatmap_scale.pdf",width = 10,height = 8)
heatmap.2(depth_ordered, density.info = "none",
dendrogram = "row", Rowv = as.dendrogram(row_cluster),
Colv = "NA", trace = "none",
scale = "row", col = colorRampPalette(brewer.pal(9, "YlGnBu"))(256),
cexRow = 1, cexCol = 2,
srtCol = 0, # rotate column labels
rowsep = c(3,8,9,16), sepwidth = c(0.1,0.1), # add row separation for major clusters
symkey = FALSE,symm = FALSE,
lmat = lmat, key.par=list(mar=c(3.5,0,9.5,11)),
margins = c(3,10))
dev.off()
pdf("Cd_Heatmap_NOscale.pdf",width = 10,height = 8)
heatmap.2(depth_ordered, density.info = "none",
dendrogram = "row", Rowv = as.dendrogram(row_cluster),
Colv = "NA", trace = "none",
col = my_palette,
cexRow = 1, cexCol = 2,
symkey = FALSE,symm = FALSE,
rowsep=c(3,8,9,16), sepwidth = c(0.1, 0.1), # add row separation for major clusters
srtCol = 0, # rotate column labels
lmat = lmat, key.par=list(mar=c(3.5,0,9.5,11)),
margins = c(3,10))
dev.off()
View(depth_ordered)
heatmap.2(df$Cd, density.info = "none",
Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),
trace = "none", col = redgreen(75),
scale = "row", cexRow = 1, cexCol = 1,
symkey = FALSE,symm = FALSE,
srtCol = 0, # rotate column labels
margins = c(5,13))
heatmap.2(df$Cd, density.info = "none",
Rowv = as.dendrogram(row_cluster), Colv = as.dendrogram(col_cluster),
trace = "none", col = redgreen(75),
scale = "row", cexRow = 1, cexCol = 1,
symkey = FALSE,symm = FALSE,
srtCol = 0, # rotate column labels
margins = c(5,13))
heatmap.2(df$Cd, density.info = "none",
Rowv = as.dendrogram(row_cluster), Colv = none,
trace = "none", col = redgreen(75),
scale = "row", cexRow = 1, cexCol = 1,
symkey = FALSE,symm = FALSE,
srtCol = 0, # rotate column labels
margins = c(5,13))
heatmap.2(df$Cd, density.info = "none",
dendrogram = "row", Rowv = as.dendrogram(row_cluster),
Colv = "NA", trace = "none",
scale = "row", col = colorRampPalette(brewer.pal(9, "YlGnBu"))(256),
cexRow = 1, cexCol = 2,
srtCol = 0, # rotate column labels
rowsep = c(3,8,9,16), sepwidth = c(0.1,0.1), # add row separation for major clusters
symkey = FALSE,symm = FALSE,
lmat = lmat, key.par=list(mar=c(3.5,0,9.5,11)),
margins = c(3,10))
View(speed)
View(df$speed)
source('~/.active-rstudio-document', echo=TRUE)
heatmap.2(df$Cd, density.info = "none",
dendrogram = "row", Rowv = as.dendrogram(row_cluster),
Colv = "NA", trace = "none",
scale = "row", col = colorRampPalette(brewer.pal(9, "YlGnBu"))(256),
cexRow = 1, cexCol = 2,
srtCol = 0, # rotate column labels
rowsep = c(3,8,9,16), sepwidth = c(0.1,0.1), # add row separation for major clusters
symkey = FALSE,symm = FALSE,
lmat = lmat, key.par=list(mar=c(3.5,0,9.5,11)),
margins = c(3,10))
heatmap.2(df$Cd, density.info = "none",
+ dendrogram = "row", Rowv = as.dendrogram(row_cluster),
+ Colv = "NA", trace = "none",
+ scale = "row", col = colorRampPalette(brewer.pal(9, "YlGnBu"))(256),
+ cexRow = 1, cexCol = 2,
+ srtCol = 0, # rotate column labels
+ rowsep = c(3,8,9,16), sepwidth = c(0.1,0.1), # add row separation for major clusters
+ symkey = FALSE,symm = FALSE,
+ lmat = lmat, key.par=list(mar=c(2.5,0,9.5,11)),
+ margins = c(3,10)
+ title('Depth Ordered'))
heatmap.2(df$Cd, density.info = "none",
dendrogram = "row", Rowv = as.dendrogram(row_cluster),
Colv = "NA", trace = "none",
scale = "row", col = colorRampPalette(brewer.pal(9, "YlGnBu"))(256),
cexRow = 1, cexCol = 2,
srtCol = 0, # rotate column labels
rowsep = c(3,8,9,16), sepwidth = c(0.1,0.1), # add row separation for major clusters
symkey = FALSE,symm = FALSE,
lmat = lmat, key.par=list(mar=c(2.5,0,9.5,11)),
margins = c(3,10)
title('Depth Ordered'))
heatmap.2(df$Cd, density.info = "none",
dendrogram = "row", Rowv = as.dendrogram(row_cluster),
Colv = "NA", trace = "none",
scale = "row", col = colorRampPalette(brewer.pal(9, "YlGnBu"))(256),
cexRow = 1, cexCol = 2,
srtCol = 0, # rotate column labels
rowsep = c(3,8,9,16), sepwidth = c(0.1,0.1), # add row separation for major clusters
symkey = FALSE,symm = FALSE,
lmat = lmat, key.par=list(mar=c(2.5,0,9.5,11)),
margins = c(3,10),
title('Depth Ordered'))
heatmap.2(df$Cd, density.info = "none",
dendrogram = "row", Rowv = as.dendrogram(row_cluster),
Colv = "NA", trace = "none",
scale = "row", col = colorRampPalette(brewer.pal(9, "YlGnBu"))(256),
cexRow = 1, cexCol = 2,
srtCol = 0, # rotate column labels
rowsep = c(3,8,9,16), sepwidth = c(0.1,0.1), # add row separation for major clusters
symkey = FALSE,symm = FALSE,
lmat = lmat, key.par=list(mar=c(3.5,0,9.5,11)),
margins = c(3,10),
title('Depth Ordered'))
rownames(df$Cd)
df$name
rownames(df$Cd) <- sub(".*?20120912_(.*?).c.*", "\\1",rownames(df$Cd))
rownames(df$Cd)
?sub
sub(rownames(df$Cd),".*?20120912_")
sub(".*?20120912_",rownames(df$Cd))
sub(".*?20120912_"," ",rownames(df$Cd))
sub(".*?20120912_","",rownames(df$Cd))
rownames(df$Cd) <- sub(".*?20120912_","",df$name)
rownames(df$Cd)
rownames(df$Cd) <- sub("\ ","",rownames(df$Cd))
rownames(df$Cd)
rownames(df$Cd) <- sub(".*\","",rownames(df$Cd))
)
)
)
)
)
]
""
rownames(df$Cd) <- sub(".*\"," ",rownames(df$Cd))
""
rownames(df$Cd) <- sub(".*?\"," ",rownames(df$Cd))
""
rownames(df$Cd) <- sub("*\"," ",rownames(df$Cd))
""
rownames(df$Cd) <- sub("\"," ",rownames(df$Cd))
""
rownames(df$Cd) <- sub("?\","",rownames(df$Cd))
""
rownames(df$Cd) <- sub(".*?20120912_","",df$name)
row_distance = dist(df$Cd, method = "manhattan")
row_cluster = hclust(row_distance, method = "ward.D")
col_distance = dist(t(df$Cd), method = "manhattan")
col_cluster = hclust(col_distance, method = "ward.D")
heatmap.2(df$Cd, density.info = "none",
dendrogram = "row", Rowv = as.dendrogram(row_cluster),
Colv = "NA", trace = "none",
scale = "row", col = colorRampPalette(brewer.pal(9, "YlGnBu"))(256),
cexRow = 1, cexCol = 2,
srtCol = 0, # rotate column labels
rowsep = c(3,8,9,16), sepwidth = c(0.1,0.1), # add row separation for major clusters
symkey = FALSE,symm = FALSE,
lmat = lmat, key.par=list(mar=c(3.5,0,9.5,11)),
margins = c(3,10),
title('Depth Ordered'))
heatmap.2(df$Cd, density.info = "none",
dendrogram = "row", Rowv = as.dendrogram(row_cluster),
Colv = "NA", trace = "none",
scale = "row", col = colorRampPalette(brewer.pal(9, "YlGnBu"))(256),
cexRow = 1, cexCol = 2,
srtCol = 0, # rotate column labels
rowsep = c(3,8,9,16), sepwidth = c(0.1,0.1), # add row separation for major clusters
symkey = FALSE,symm = FALSE,
lmat = lmat, key.par=list(mar=c(3.5,0,9.5,11)),
margins = c(3,10))
rownames(df$Cd)
